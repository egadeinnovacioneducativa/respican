<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RespiCan - Contador</title>
    <style>
        /* --- ESTILOS GENERALES (CSS) --- */
        :root {
            --bg-color: #fff7ed;
            --primary: #f97316;    /* Naranja */
            --secondary: #ea580c;  /* Naranja oscuro */
            --success: #22c55e;    /* Verde */
            --success-dark: #15803d;
            --text-color: #7c2d12; /* Marrón */
            --white: #ffffff;
            --border: #fed7aa;
        }

        body {
            background-color: var(--bg-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none; /* Safari */
            -webkit-tap-highlight-color: transparent;
        }

        /* --- HEADER --- */
        header {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
        }

        h1 {
            font-size: 28px;
            font-weight: 900;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 0;
        }

        .subtitle {
            font-size: 14px;
            color: var(--text-color);
            opacity: 0.8;
            margin-top: 5px;
        }

        /* --- ÁREA PRINCIPAL --- */
        #main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 400px;
        }

        /* --- TEMPORIZADOR --- */
        #timer-badge {
            background-color: var(--white);
            border: 2px solid var(--border);
            border-radius: 50px;
            padding: 8px 24px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            opacity: 0; /* Oculto por defecto */
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }

        #timer-badge.visible {
            opacity: 1;
            transform: translateY(0);
        }

        #timer-text {
            font-size: 24px;
            font-family: monospace;
            font-weight: bold;
            color: var(--secondary);
        }

        /* --- BOTÓN GIGANTE --- */
        #big-button {
            width: 260px;
            height: 260px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.1s;
            outline: none;
            box-shadow: 0 15px 35px rgba(234, 88, 12, 0.4);
            background: linear-gradient(145deg, var(--primary), var(--secondary));
        }

        #big-button:active {
            transform: scale(0.95);
        }

        /* Estado contando (Verde) */
        #big-button.counting {
            background: linear-gradient(145deg, var(--success), var(--success-dark));
            box-shadow: 0 15px 35px rgba(34, 197, 94, 0.4);
        }

        /* Anillo decorativo dentro del botón */
        .btn-ring {
            position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            pointer-events: none;
        }

        .btn-label {
            font-size: 20px;
            font-weight: 800;
            color: rgba(255,255,255,0.95);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
        }

        #count-display {
            font-size: 56px;
            font-weight: 900;
            color: var(--white);
            line-height: 1;
            margin-top: 5px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        /* --- TARJETA DE RESULTADOS (Oculta por defecto) --- */
        #result-card {
            display: none; /* Oculto con display none */
            background-color: var(--white);
            width: 100%;
            border-radius: 24px;
            padding: 30px;
            border: 4px solid var(--border);
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .heart-icon-bg {
            background-color: #fee2e2;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px auto;
        }

        .result-number {
            font-size: 64px;
            font-weight: 900;
            color: var(--secondary);
            line-height: 1;
            margin-bottom: 5px;
        }

        .result-text {
            color: var(--primary);
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 25px;
        }

        .summary-box {
            background-color: var(--bg-color);
            border-radius: 12px;
            padding: 15px;
            text-align: left;
            color: var(--text-color);
            font-size: 14px;
            margin-bottom: 25px;
        }

        .summary-box ul {
            margin: 0;
            padding-left: 20px;
        }

        .summary-box li {
            margin-bottom: 5px;
        }

        #reset-btn {
            width: 100%;
            background-color: var(--primary);
            color: var(--white);
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* --- FOOTER --- */
        footer {
            position: absolute;
            bottom: 20px;
            font-size: 12px;
            color: var(--text-color);
            opacity: 0.6;
            text-align: center;
        }

        /* --- SVG STYLES --- */
        svg { display: block; }
        .hidden { display: none !important; }

    </style>
</head>
<body>

    <!-- HEADER -->
    <header>
        <h1>
            <!-- Icono Patita Izq -->
            <svg width="28" height="28" viewBox="0 0 24 24" fill="#ea580c" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM7 5C5.9 5 5 5.9 5 7C5 8.1 5.9 9 7 9C8.1 9 9 8.1 9 7C9 5.9 8.1 5 7 5ZM17 5C15.9 5 15 5.9 15 7C15 8.1 15.9 9 17 9C18.1 9 19 8.1 19 7C19 5.9 18.1 5 17 5ZM6.5 11C5.12 11 4 12.12 4 13.5C4 15.5 6 19 10 21C10.8 21.4 11.4 21.4 12.2 21C12.5 20.85 12.8 20.68 13.1 20.5C13.38 20.33 13.67 20.16 14 20.05C18 19 20 15.5 20 13.5C20 12.12 18.88 11 17.5 11C16.35 11 15.39 11.78 15.07 12.83L15 13L14 12.5C13.3 12.15 12.5 12 11.7 12C11.3 12 10.9 12.05 10.5 12.15C10.44 12.17 10.38 12.18 10.32 12.2L10 12.3L9.8 12C9.3 11.4 8.6 11 7.8 11C7.35 11 6.91 11.17 6.5 11.48V11H6.5Z"/></svg>
            RespiCan
            <!-- Icono Patita Der -->
            <svg width="28" height="28" viewBox="0 0 24 24" fill="#ea580c" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM7 5C5.9 5 5 5.9 5 7C5 8.1 5.9 9 7 9C8.1 9 9 8.1 9 7C9 5.9 8.1 5 7 5ZM17 5C15.9 5 15 5.9 15 7C15 8.1 15.9 9 17 9C18.1 9 19 8.1 19 7C19 5.9 18.1 5 17 5ZM6.5 11C5.12 11 4 12.12 4 13.5C4 15.5 6 19 10 21C10.8 21.4 11.4 21.4 12.2 21C12.5 20.85 12.8 20.68 13.1 20.5C13.38 20.33 13.67 20.16 14 20.05C18 19 20 15.5 20 13.5C20 12.12 18.88 11 17.5 11C16.35 11 15.39 11.78 15.07 12.83L15 13L14 12.5C13.3 12.15 12.5 12 11.7 12C11.3 12 10.9 12.05 10.5 12.15C10.44 12.17 10.38 12.18 10.32 12.2L10 12.3L9.8 12C9.3 11.4 8.6 11 7.8 11C7.35 11 6.91 11.17 6.5 11.48V11H6.5Z"/></svg>
        </h1>
        <div class="subtitle">Calculadora de Respiración</div>
    </header>

    <!-- ÁREA CENTRAL -->
    <div id="main-area">
        
        <!-- Temporizador -->
        <div id="timer-badge">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span id="timer-text">00:10</span>
        </div>

        <!-- Botón Gigante (Play / Contar) -->
        <button id="big-button">
            <div class="btn-ring"></div>
            
            <!-- Contenido Inicial: Play -->
            <div id="content-idle">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg"><path d="M8 5V19L19 12L8 5Z"/></svg>
                <div class="btn-label">INICIAR</div>
            </div>

            <!-- Contenido Contando: Patita + Numero -->
            <div id="content-counting" class="hidden">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="rgba(255,255,255,0.9)" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM7 5C5.9 5 5 5.9 5 7C5 8.1 5.9 9 7 9C8.1 9 9 8.1 9 7C9 5.9 8.1 5 7 5ZM17 5C15.9 5 15 5.9 15 7C15 8.1 15.9 9 17 9C18.1 9 19 8.1 19 7C19 5.9 18.1 5 17 5ZM6.5 11C5.12 11 4 12.12 4 13.5C4 15.5 6 19 10 21C10.8 21.4 11.4 21.4 12.2 21C12.5 20.85 12.8 20.68 13.1 20.5C13.38 20.33 13.67 20.16 14 20.05C18 19 20 15.5 20 13.5C20 12.12 18.88 11 17.5 11C16.35 11 15.39 11.78 15.07 12.83L15 13L14 12.5C13.3 12.15 12.5 12 11.7 12C11.3 12 10.9 12.05 10.5 12.15C10.44 12.17 10.38 12.18 10.32 12.2L10 12.3L9.8 12C9.3 11.4 8.6 11 7.8 11C7.35 11 6.91 11.17 6.5 11.48V11H6.5Z"/></svg>
                <div class="btn-label">¡PRESIONA!</div>
                <div id="count-display">0</div>
            </div>
        </button>

        <!-- Tarjeta de Resultados -->
        <div id="result-card">
            <div class="heart-icon-bg">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="#ef4444" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.27 2 8.5C2 5.41 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.08C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.41 22 8.5C22 12.27 18.6 15.36 13.45 20.03L12 21.35Z"/></svg>
            </div>
            
            <h2 style="color: #7c2d12; margin: 0 0 5px 0;">Resultado</h2>
            <div id="bpm-display" class="result-number">0</div>
            <div class="result-text">Respiraciones / min</div>
            
            <div class="summary-box">
                <ul>
                    <li>Contaste <strong id="raw-count">0</strong> respiraciones</li>
                    <li>En <strong>10</strong> segundos</li>
                </ul>
            </div>

            <button id="reset-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg>
                Medir de nuevo
            </button>
        </div>

    </div>

    <!-- FOOTER -->
    <footer>
        Presiona el botón cada vez que suba el pecho
    </footer>

    <!-- LÓGICA JAVASCRIPT -->
    <script>
        // Variables de estado
        let gameState = 'idle'; // idle, counting, finished
        let timeLeft = 10;
        let count = 0;
        let timerInterval = null;

        // Elementos del DOM
        const bigButton = document.getElementById('big-button');
        const contentIdle = document.getElementById('content-idle');
        const contentCounting = document.getElementById('content-counting');
        const timerBadge = document.getElementById('timer-badge');
        const timerText = document.getElementById('timer-text');
        const countDisplay = document.getElementById('count-display');
        
        const resultCard = document.getElementById('result-card');
        const rawCountSpan = document.getElementById('raw-count');
        const bpmDisplay = document.getElementById('bpm-display');
        const resetBtn = document.getElementById('reset-btn');

        // Manejador del botón principal
        bigButton.addEventListener('click', () => {
            // Animación visual de "tap"
            bigButton.style.transform = "scale(0.95)";
            setTimeout(() => bigButton.style.transform = "scale(1)", 100);

            if (gameState === 'idle') {
                startTimer();
            } else if (gameState === 'counting') {
                incrementCount();
            }
        });

        // Manejador del botón de reinicio
        resetBtn.addEventListener('click', resetApp);

        function startTimer() {
            gameState = 'counting';
            count = 0;
            timeLeft = 10;
            
            // Actualizar UI
            countDisplay.textContent = count;
            timerText.textContent = "00:10";
            
            contentIdle.classList.add('hidden');
            contentCounting.classList.remove('hidden');
            bigButton.classList.add('counting');
            timerBadge.classList.add('visible');

            // Iniciar intervalo
            timerInterval = setInterval(() => {
                timeLeft--;
                timerText.textContent = `00:0${timeLeft}`;

                if (timeLeft <= 0) {
                    finishCounting();
                }
            }, 1000);
        }

        function incrementCount() {
            count++;
            countDisplay.textContent = count;
        }

        function finishCounting() {
            clearInterval(timerInterval);
            gameState = 'finished';

            // Cálculos
            const bpm = count * 6;
            
            // Mostrar resultados
            rawCountSpan.textContent = count;
            bpmDisplay.textContent = bpm;

            // Ocultar botón gigante y mostrar tarjeta
            bigButton.classList.add('hidden'); // O usar style.display = 'none'
            bigButton.style.display = 'none';
            timerBadge.classList.remove('visible');
            resultCard.style.display = 'block';
        }

        function resetApp() {
            gameState = 'idle';
            timeLeft = 10;
            count = 0;

            // Restaurar UI
            resultCard.style.display = 'none';
            bigButton.style.display = 'flex';
            bigButton.classList.remove('counting');
            contentIdle.classList.remove('hidden');
            contentCounting.classList.add('hidden');
            timerBadge.classList.remove('visible');
        }
    </script>
</body>
</html>
